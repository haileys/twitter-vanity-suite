#!/usr/bin/env ruby
require_relative "../lib-internal/common"

def usage
  abort "Usage: twitter-intersect (<username>.following|<username>.followers)..."
end

usage if ARGV.empty?

ids = ARGV.map { |arg| arg.split(".") }.map { |handle, command|
  case command
  when "following"
    $client.friend_ids(handle).to_a
  when "followers"
    $client.follower_ids(handle).to_a
  else
    puts "Unknown command: #{command}"
    puts
    usage
  end
}

puts $client.users(ids.reduce(:&)).map(&:screen_name)
